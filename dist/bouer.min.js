!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Bouer=t()}(this,(function(){"use strict";var e=function(){function e(){}return e.log=function(t){console.log(e.prefix,t)},e.error=function(t){console.error(e.prefix,t)},e.warn=function(t){console.warn(e.prefix,t)},e.info=function(t){console.info(e.prefix,t)},e.prefix="[Bouer]",e}(),t=document,r=setInterval,n=function(e){return void 0===e||null==e},i=function(e){return"object"==typeof e&&"[object Object]"===String(e)},o=function(e){return void 0!==e&&"string"==typeof e},a=function(e){return!e||!i(e)||0===Object.keys(e).length},u=function(e){return"function"==typeof e},s=function(e){return e?e.trim():e},c=function(e){return e.toLowerCase()},l=function(e){return function(e){return"string"==typeof e||"number"==typeof e||"symbol"==typeof e||"boolean"==typeof e}(e)?String(e):i(e)?JSON.stringify(e):u(e.toString)?e.toString():String(e)},f=function(e,t,r){return Object.defineProperty(e,t,r),e},d=function(e,t,r){f(e,r,p(t,r))},p=function(e,t){return Object.getOwnPropertyDescriptor(e,t)},h=function(e,t,r){void 0===r&&(r=!1);var i=null;if(!e)return null;for(var o=0,a=t;o<a.length;o++){var u=a[o];if(i=e.attributes[u])break}return!n(i)&&r&&e.removeAttribute(i.name),i},v=function(e,t,r){for(var n=0;n<e.length;n++)u(t)&&t.call(r,e[n],n)},m=function(e,r){var n=t.createElement(e);u(r)&&r(n,t);var i={appendTo:function(e){return e.appendChild(n),i},build:function(){return n}};return i},b=function(e,t){v(Object.keys(e),(function(r){var n=t,o=e[r];if(r in n)return i(o)?b(o,n[r]):n[r]=o;d(t,e,r)}))},y=function(e,t){return f(e,"isConnected",{get:function(){return t.isConnected}}),e},g=function(){function e(t){this.delimiters=[],this.delimiters=t,e.singleton=this}return e.prototype.add=function(e){this.delimiters.push(e)},e.prototype.remove=function(e){var t=this.delimiters.findIndex((function(t){return t.name===e}));this.delimiters.splice(t,1)},e.prototype.run=function(e){var t=this;if(n(e)||""===s(e))return[];var r=null,i=function(e,n){for(var i=0;i<t.delimiters.length;i++){var o=t.delimiters[i],a=e.match(RegExp(o.delimiter.open+"([\\S\\s]*?)"+o.delimiter.close,n||""));if(a)return r=o,a}},o=i(e,"g");return o?o.map((function(e){var t=i(e);return{field:t[0],expression:s(t[1]),delimiter:r}})):[]},e}(),N=function(){function e(){}return e.value=function(e,t,r){return n(r)?t in e?e[t]:e.getAttribute(t)||e.innerText:(e.setAttribute(t,r),e.getAttribute(t))},e}(),w={ignore:"e-ignore",build:"e-build",array:"e-array",if:"e-if",elseif:"e-else-if",else:"e-else",show:"e-show",req:"e-req",tmp:"e-tmp",fill:"e-fill",for:"e-for",use:"e-use",id:"e-id",order:"e-order",filter:"e-filter",data:"data",def:"e-def",wait:"wait-data",toggle:"e-toggle",content:"e-content",bind:"e-bind",property:"e-",anm:"e-anm",skeleton:"e-skeleton",route:"route-view",href:":href",ihref:"!href",copy:"e-copy",component:":name",on:"on:",check:function(e,t){return e.nodeName.substr(0,t.length)===t},isConstant:function(e){var t=this;return-1!==Object.keys(this).map((function(e){return t[e]})).indexOf(e)}},A=function(){function e(){}return e.obj=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r={};return v(e,(function(e){n(e)||v(Object.keys(e),(function(t){var i=e[t];n(i)||d(r,e,t)}))})),r},e.addToObj=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return v(t,(function(t){n(t)||v(Object.keys(t),(function(r){var i=t[r];n(i)||d(e,t,r)}))})),e},e.array=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=[];return v(e,(function(e){n(e)||v(Object.keys(e),(function(t){var i=e[t];n(i)||(Array.isArray(i)?[].push.apply(r,i):r.push(i))}))})),r},e}(),x=function(){function t(e){this.bouer=e,this.global=this.createWindow(),t.singleton=this}return t.prototype.createWindow=function(){var e;return m("iframe",(function(t,r){t.style.display="none!important",r.body.appendChild(t),e=t.contentWindow,r.body.removeChild(t)})),e},t.prototype.exec=function(t){var r=this,n=t.data,i=t.args,o=t.expression,a=t.isReturn,u=t.aditional,s=this.global,c={},l=A.obj(u||{});v(Object.keys(n),(function(e){d(l,n,e)})),v(Object.keys(this.bouer.globalData),(function(t){if(t in l)return e.warn('It was not possible to use the globalData property "'+t+'" because it already defined in the current scope.');d(l,r.bouer.globalData,t)}));var f,h=Object.keys(l);v(h,(function(e){delete s[e],e in s&&!0===p(s,e).configurable&&(c[e]=s[e]),e in c&&(s[e]=l[e]),d(s,l,e)}));try{var m='return(function(){"use strict"; '+(!1===a?"":"return")+" "+o+" }).apply(this, arguments)";f=this.global.Function(m).apply(this.bouer,i)}catch(t){t.stack="",e.error(t)}return v(h,(function(e){return delete s[e]})),f},t}(),O=function(){function t(){}return t.on=function(e,t){return this[e].push(t),{eventName:e,callback:t}},t.off=function(e,t){var r=this[e];return r.splice(r.indexOf(t),1),{eventName:e,callback:t}},t.emit=function(t,r,n,i){try{v(this[t],(function(e){return e(r,n,i)}))}catch(t){t.stack="",e.error(t)}},t.BeforeGet=[],t.AfterGet=[],t.BeforeSet=[],t.AfterSet=[],t.BeforeArrayChanges=[],t.AfterArrayChanges=[],t}(),k=function(){function e(t){this.binds=[],this.DEFAULT_BINDER_PROPERTIES={text:"value",number:"valueAsNumber",checkbox:"checked",radio:"checked"},this.BindingDirection={fromInputToData:"to-data-property",fromDataToInput:"to-input"},e.singleton=this,this.evaluator=x.singleton,this.bouer=t,this.cleanup()}return e.prototype.create=function(e){var t,r=this,o=e.node,a=e.data,c=e.fields,f=e.eReplace,d=s(null!==(t=o.nodeValue)&&void 0!==t?t:""),p=o.nodeName,h=o.ownerElement||o.parentNode,b=e.onChange||function(e,t){},y={name:p,value:d,bindOptions:e,boundNode:o};if(p.substr(0,w.bind.length)===w.bind){var g="";g=w.bind===p?this.DEFAULT_BINDER_PROPERTIES[h.type]||"value":p.split(":")[1];var N=function(e,t){switch(e){case r.BindingDirection.fromDataToInput:return h[g]=t;case r.BindingDirection.fromInputToData:return a[d]=h[g]}},A=O.on("AfterGet",(function(e){r.binds.push(e.watch((function(e){N(r.BindingDirection.fromDataToInput,e),b(e,o)}),o))})),x=this.evaluator.exec({expression:d,data:a});A&&O.off("AfterGet",A.callback),h[g]=i(x)?l(x):n(x)?"":x;var k=[h.nodeName.toLowerCase(),"propertychange","change"],E=function(){N(r.BindingDirection.fromInputToData,h[g])};return v(k,(function(e){return h.addEventListener(e,E,!1)})),h.removeAttribute(o.nodeName),y}var j=o;p.substr(0,w.property.length)===w.property&&n(f)&&(y.name=p.substr(w.property.length),h.setAttribute(y.name,d),j=h.attributes[y.name],h.removeAttribute(o.nodeName));var T=function(){var e=y.value,t=!1;if(v(c,(function(i){var s=i.delimiter;s&&"html"===s.name&&(t=!0);var c=r.evaluator.exec({expression:i.expression,data:a});c=n(c)?"":c,e=e.replace(i.field,l(c)),s&&u(s.action)&&(e=s.action(e,o,a))})),t){var i=m("div",(function(t){t.innerHTML=e})).build().children[0];h.appendChild(i)}else j.nodeValue=e},I=O.on("BeforeGet",(function(e){r.binds.push(e.watch((function(e){T(),b(e,o)}),o))}));return T(),I&&O.off("BeforeGet",I.callback),y.boundNode=j,y},e.prototype.cleanup=function(){var e=this;r((function(){return v(e.binds,(function(t,r){t.node&&(t.node.isConnected||(t.destroy(),e.binds.splice(r,1)))}))}),1e3)},e}(),E=function(e){var t=this;this.composedPath=function(){return t.source.composedPath()},this.initEvent=function(e,r,n){return t.source.initEvent(e,r,n)},this.preventDefault=function(){return t.source.preventDefault()},this.stopImmediatePropagation=function(){return t.source.stopImmediatePropagation()},this.stopPropagation=function(){return t.source.stopPropagation()};var r=e.source,n=e.type;this.source=r||new Event(n),this.bubbles=this.source.bubbles,this.cancelBubble=this.source.cancelBubble,this.cancelable=this.source.cancelable,this.composed=this.source.composed,this.currentTarget=this.source.currentTarget,this.defaultPrevented=this.source.defaultPrevented,this.eventPhase=this.source.eventPhase,this.isTrusted=this.source.isTrusted,this.target=this.source.target,this.timeStamp=this.source.timeStamp,this.type=this.source.type,this.returnValue=this.source.returnValue,this.srcElement=this.source.srcElement,this.AT_TARGET=this.source.AT_TARGET,this.BUBBLING_PHASE=this.source.BUBBLING_PHASE,this.CAPTURING_PHASE=this.source.CAPTURING_PHASE,this.NONE=this.source.NONE},j=function(){function t(e){this.events=[],t.singleton=this,this.bouer=e,this.evaluator=x.singleton,this.input=m("input").build()}return t.prototype.handle=function(t,r){var i,o=this,a=t.ownerElement||t.parentNode,l=t.nodeName;if(n(a))return e.error('Invalid ParentElement of "'+l+'"');var f=s(null!==(i=t.nodeValue)&&void 0!==i?i:""),d=l.substr(w.on.length).split("."),p=d[0];d.shift(),""===f&&e.error('Expected an expression in the "'+l+'" and got an <empty string>.');var h=function(t,n){var i=-1!==d.indexOf("once");v(d,(function(e){v(Object.keys(t),(function(r){var n;(n=t[r]&&u(n)&&c(r)===c(e))&&n()}))}));var a=new E({source:t,type:t.type}),s=A.array(a,n),l=o.evaluator.exec({data:A.obj(r,{event:a}),expression:f,args:s});if(u(l))try{l.apply(o.bouer,s)}catch(t){t.stack="",e.error(t)}return i};if("on"+p in this.input){var m=function(e){h(e,[])&&a.removeEventListener(p,m,!1)};a.addEventListener(p,m,!1)}else this.on(p,h)},t.prototype.on=function(e,t){var r={eventName:e,callback:function(e,r){return t(e,r)}};return this.events.push(r),r},t.prototype.off=function(e,t){var r=-1,n=this.events.find((function(n,i){if(n.eventName===e&&t==n.callback)return r=i,!0}));return n&&this.events.splice(r,1),n},t.prototype.emit=function(e){var t=this,r=e.eventName,n=e.arguments;v(this.events,(function(e){r===e.eventName&&e.callback.call(t.bouer,new E({type:r}),n||[])}))},t}();var T=function(e,t,r){var n=this;this.destroy=function(){var e=n.reactive.watches.indexOf(n);-1!==e&&n.reactive.watches.splice(e,1),n.onDestroy&&n.onDestroy()},this.reactive=e,this.property=e.propertyName,this.callback=t,r&&(this.node=r.node,this.onDestroy=r.onDestroy)},I=function(){function e(t){this.bouer=t,e.singleton=this}return e.prototype.create=function(e){var r=t.createComment("e");return r.id=e||function(e){for(var t="01234567890ABCDEFGHIJKLMNOPQRSTUVWXYZ",r=!1,n="",i=0;i<(e||8);i++){var o=Math.floor(Math.random()*t.length);n+=r?t[o].toLowerCase():t[o],r=!r}return n}(8),r},e.prototype.get=function(e,t){if(!n(e))return t=t||this.bouer.el,this.retrieve(t).find((function(t){return t.id===e}))},e.prototype.retrieve=function(e){if(!e)return[];for(var r,n=t.createNodeIterator(e,NodeFilter.SHOW_COMMENT,(function(){return NodeFilter.FILTER_ACCEPT})),i=[];r=n.nextNode();)"id"in r&&i.push(r);return i},e}(),V=function(){function t(e){var r=this;this.watches=[],this.get=function(){O.emit("BeforeGet",r);var e=r.propertyValue;return O.emit("AfterGet",r),e},this.set=function(e){var o=r.propertyValue;o!==e&&(O.emit("BeforeSet",r),i(e)||Array.isArray(e)?Array.isArray(e)?(t.transform(e,r),n(r.propertyValue)?r.propertyValue=e:(Array.isArray(r.propertyValue)&&r.propertyValue.splice(0,r.propertyValue.length),[].push.apply(r.propertyValue,e))):i(e)&&(e instanceof Node?r.propertyValue=e:(t.transform(e),n(r.propertyValue)?r.propertyValue=e:b(r.propertyValue,e))):r.propertyValue=e,O.emit("AfterSet",r),v(r.watches,(function(e){return e.callback(r.propertyValue,o)})))},this.propertyName=e.propertyName,this.propertySource=e.sourceObject,this.propertyDescriptor=p(this.propertySource,this.propertyName),this.propertyValue=this.propertyDescriptor.value}var r;return t.prototype.watch=function(e,t){var r=new T(this,e,{node:t});return this.watches.push(r),r},r=t,t.transform=function(o,a){if(Array.isArray(o)){if(null==a)return e.warn("Cannot transform this array to a reactive one because no reactive objecto was provided"),o;var u=o,s={},c=u.__proto__=Object.create(Array.prototype);return v(["push","pop","unshift","shift","splice"],(function(e){s[e]=u[e].bind(u),c[e]=function(){var t=u.slice();O.emit("BeforeArrayChanges",a,e,{arrayNew:t,arrayOld:t});var r=s[e].apply(u,arguments);return O.emit("AfterArrayChanges",a,e,{arrayNew:t,arrayOld:t}),r}})),u}return i(o)?(v(Object.keys(o),(function(e){var a=o;if(!n(p(o,e).value)){var u=new t({propertyName:e,sourceObject:o});f(o,e,u);var s=a[e];i(s)?r.transform(s):Array.isArray(s)&&(r.transform(s,u),v(s,(function(e){return r.transform(e)})))}})),o):o},t}(),C=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.node=e}return e.prototype.connect=function(e){v(this.node,(function(t){return y(t,e)}))},e}(),D=function(){function t(e,t){this.errorMsgEmptyNode=function(e){return'Expected an expression in "'+e.nodeName+'" and got an <empty string>.'},this.errorMsgNodeValue=function(e){var t;return'Expected an expression in "'+e.nodeName+'" and got "'+(null!==(t=e.nodeValue)&&void 0!==t?t:"")+'".'},this.bouer=e,this.htmlHandler=t,this.evaluator=x.singleton,this.delimiter=g.singleton,this.binder=k.singleton,this.comment=I.singleton}return t.prototype.toOwnerNode=function(e){return e.ownerElement||e.parentNode},t.prototype.returner=function(e,t){return u(t)&&t(),new(C.bind.apply(C,function(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}([void 0],e,!1)))},t.prototype.ignore=function(e){e.nodeValue="true"},t.prototype.if=function(t,r){var n,i,o=this,a=this.toOwnerNode(t),u=a.parentElement,c=[],l=this.comment.create(),f=t.nodeName,d=function(){};if(!u)return this.returner(t);if(f===w.elseif||f===w.else)return this.returner(t);var p=a,m=[],b=function(){if(null==p)return"break";var t=h(p,["e-if","e-else-if","e-else"]);if(!t)return"break";if("e-else"!==t.nodeName&&""===s(null!==(n=t.nodeValue)&&void 0!==n?n:""))return{value:g.returner(t,(function(){return e.error(o.errorMsgEmptyNode(t))}))};if(0!==g.delimiter.run(null!==(i=t.nodeValue)&&void 0!==i?i:"").length)return{value:g.returner(t,(function(){return e.error(o.errorMsgNodeValue(t))}))};if(c.push({node:t,element:p}),y(p,u),y(t,u),"e-else"===t.nodeName)return p.removeAttribute(t.nodeName),"break";var a=O.on("BeforeGet",(function(e){-1===m.findIndex((function(t){return t.reactive.propertyName==e.propertyName}))&&m.push({attr:t,reactive:e})}));g.evaluator.exec({data:r,expression:t.value}),a&&O.off("BeforeGet",a.callback),p.removeAttribute(t.nodeName)},g=this;do{var N=b();if("object"==typeof N)return N.value;if("break"===N)break}while(p=p.nextElementSibling);return v(m,(function(e){return o.binder.binds.push(e.reactive.watch((function(){return d()}),e.attr))})),(d=function(){var e;v(c,(function(e){e.element.parentElement&&(l.isConnected?u.removeChild(e.element):u.replaceChild(l,e.element))}));for(var t=null,n=0;n<c.length;n++){var i=c[n],a=i.node,f=i.element,d=s(null!==(e=a.nodeValue)&&void 0!==e?e:"");if(t)break;if("e-else"!==a.nodeName)if(!o.evaluator.exec({expression:d,data:r}))continue;u.replaceChild(f,l),t=f,o.htmlHandler.compile({el:f,data:r})}})(),this.returner(c.map((function(e){return e.node})))},t.prototype.show=function(t,r){var n,i=this,o=this.toOwnerNode(t),a=s(null!==(n=t.nodeValue)&&void 0!==n?n:""),u=0!==this.delimiter.run(a).length;if(""===a)return this.returner(t,(function(){e.error(i.errorMsgEmptyNode(t))}));if(u)return this.returner(t,(function(){e.error(i.errorMsgNodeValue(t))}));var c=function(e){var t=i.evaluator.exec({expression:a,data:r});e.style.display=t?"":"none"},l=this.binder.create({data:r,node:t,fields:[{expression:a,field:a}],onChange:function(){return c(o)}});return c(o),o.removeAttribute(l.boundNode.nodeName),this.returner(t)},t.prototype.for=function(t,r){var i,o=this,a=this.toOwnerNode(t),u=a.parentElement,c=this.comment.create(),f=t.nodeName,d=s(null!==(i=t.nodeValue)&&void 0!==i?i:""),p=[],h=function(){};if(!u)return this.returner(t);if(""===d)return this.returner(t,(function(){e.error(o.errorMsgEmptyNode(t))}));if(!d.includes(" of ")&&!d.includes(" in "))return this.returner(t,(function(){e.error('Expected a valid "for" expression in "'+f+'" and got "'+d+'".\nValid: e-for="item of items".')}));var m=this.delimiter.run(d);0!==m.length&&this.binder.create({data:r,fields:m,eReplace:!0,node:t,onChange:function(){return h()}}),a.removeAttribute(f);var b=a.cloneNode(!0);u.replaceChild(c,a),y(b,c),y(t,c);var g=O.on("AfterGet",(function(e){return o.binder.binds.push(e.watch((function(){return h()}),t))})),N=O.on("AfterArrayChanges",(function(e){return h()}));return this.binder.binds.push(new T(new V({propertyName:"_",sourceObject:{_:[]}}),(function(){}),{node:t,onDestroy:function(){return O.off("AfterArrayChanges",N.callback)}})),(h=function(){var i,a=(d=s(null!==(i=t.nodeValue)&&void 0!==i?i:"")).split("|").map((function(e){return s(e)})),h=a[0].replace("(","").replace(")","");a.shift();var m=" of ",y=h.split(m);0===y.length&&(m=" in ",y=h.split(m));var g=y[0],N=y[1],w=g.split(",").map((function(e){return s(e)})),x="let "+g+(g.includes(",")?"=0":"")+";",O=w.length>1;h=[O?w[0]:g,"$$applyFilters("+N+")"].join(m),v(p,(function(e){e.parentElement&&u.removeChild(e)})),p=[],o.evaluator.exec({data:r,isReturn:!1,expression:x+"for("+h+"){  $$each("+g+(O?"++":"")+")}",aditional:{$$each:function(e,t){var n=A.obj(r);n[w[0]]=e,O&&(n[w[1]]=t),o.htmlHandler.compile({el:b.cloneNode(!0),data:n,onDone:function(e){p.push(u.insertBefore(e,c))}})},$$applyFilters:function(t){var i=A.array(t),u=function(e){return a.find((function(t){return t.substr(0,e.length)===e}))},c=u("filter");if(c){var p=c.split(":").map((function(e){return s(e)}));1==p.length?e.error('Invalid "'+f+'" filter expression "'+d+'", at least a filter-value and filter-keys, or a filter-function must be provided'):i=function(t,i){var a=i[1],u=i[2];if(n(a)||""===a)return e.error('Invalid filter-value in "'+f+'" "'+d+'" expression.'),t;if("function"==typeof(a=o.evaluator.exec({data:r,expression:a})))t=a(t);else{if(n(u)||""===u)return e.error('Invalid filter-keys in "'+f+'" "'+d+'" expression, at least one filter-key to be provided.'),t;var c=[];v(t,(function(e){for(var t=0,r=u.split(",").map((function(e){return s(e)}));t<r.length;t++){var n=r[t],i=o.evaluator.exec({data:e,expression:n});if(!l(i).includes(a))break;c.push(e)}})),t=c}return t}(i,p)}var h=u("order");if(h){var m=h.split(":").map((function(e){return s(e)}));1==m.length?e.error('Invalid "'+f+'" order  expression "'+d+'", at least the order type must be provided'):i=function(t,r,i){return r||(r="asc"),t.sort((function(t,o){var a=function(t,i){if(n(t)||n(i))return 0;switch(r.toLowerCase()){case"asc":return t?1:-1;case"desc":return i?-1:1;default:return e.log('The "'+r+'" order type is invalid: "'+d+'". Available types are: "asc" for order ascendent and "desc" for order descendent.'),0}};return i?a(t[i]>o[i],o[i]<t[i]):a(t>o,o<t)}))}(i,m[1],m[2])}return i}}})})(),O.off("AfterGet",g.callback),this.returner(t)},t.prototype.def=function(t,r){var n,o=this,a=this.toOwnerNode(t),u=s(null!==(n=t.nodeValue)&&void 0!==n?n:""),c=0!==this.delimiter.run(u).length;if(""===u)return this.returner(t,(function(){e.error(o.errorMsgEmptyNode(t))}));if(c)return this.returner(t,(function(){e.error(o.errorMsgNodeValue(t))}));var l=this.evaluator.exec({data:r,expression:u});if(!i(l))return this.returner(t,(function(){e.error('Expected a valid Object Literal expression in "'+t.nodeName+'" and got "'+u+'".')}));this.bouer.setData(l,r),a.removeAttribute(t.nodeName)},t.prototype.content=function(t){var r,n=this,i=this.toOwnerNode(t),o=s(null!==(r=t.nodeValue)&&void 0!==r?r:"");if(""===o)return this.returner(t,(function(){e.error(n.errorMsgEmptyNode(t))}));i.innerText=o,i.removeAttribute(t.nodeName)},t.prototype.bind=function(t,r){var n,i=this,o=this.toOwnerNode(t),a=s(null!==(n=t.nodeValue)&&void 0!==n?n:""),u=0!==this.delimiter.run(a).length;return""===a?this.returner(t,(function(){e.error(i.errorMsgEmptyNode(t))})):u?this.returner(t,(function(){e.error(i.errorMsgNodeValue(t))})):(this.binder.create({node:t,fields:[{field:a,expression:a}],data:r}),o.removeAttribute(t.nodeName),this.returner(t))},t.prototype.property=function(t,r){var n,o=this,a=this.toOwnerNode(t),u=s(null!==(n=t.nodeValue)&&void 0!==n?n:""),c=0!==this.delimiter.run(u).length,l=function(e){},f=function(e){var t;return'Invalid value, expected an Object/Object Literal in "'+e.nodeName+'" and got "'+(null!==(t=e.nodeValue)&&void 0!==t?t:"")+'".'};if(""===u)return this.returner(t,(function(){e.error(f(t))}));if(c)return this.returner(t);var d=this.evaluator.exec({data:r,expression:u});return i(d)?(this.binder.create({data:r,node:t,eReplace:!1,fields:[{expression:u,field:u}],onChange:function(){return l(o.evaluator.exec({data:r,expression:u}))}}),a.removeAttribute(t.nodeName),(l=function(e){var r=t.nodeName.substr(w.property.length),n=a.attributes[r];if(n||(a.setAttribute(r,""),n=a.attributes[r]),v(Object.keys(e),(function(t){if(!e[t])return n.value=s(n.value.replace(t,""));n.value=n.value.includes(t)?n.value:s(n.value+" "+t)})),""===n.value)return a.removeAttribute(r)})(d),this.returner(t)):this.returner(t,(function(){e.error(f(t))}))},t.prototype.req=function(t,r){return e.info(t),this.returner(t)},t.prototype.id=function(e,t){return this.returner(e)},t.prototype.filter=function(e,t){return this.returner(e)},t.prototype.data=function(t,r){e.warn("e-anm not implemented yet.")},t.prototype.href=function(e,t){return this.returner(e)},t.prototype.skeleton=function(t,r){e.warn("e-skeleton not implemented yet.")},t.prototype.wait=function(t,r){e.warn("wait-data not implemented yet.")},t.prototype.copy=function(t){e.warn("e-copy not implemented yet.")},t.prototype.component=function(t,r){e.warn("<component /> not implemented yet.")},t}(),S=function(){function t(e){this.NODES_TO_IGNORE_IN_COMPILATION={SCRIPT:1,"#comment":8},t.singleton=this,this.bouer=e,this.delimiter=g.singleton,this.eventHandler=j.singleton,this.binder=k.singleton,this.directive=new D(e,this)}return t.prototype.toJsObj=function(t,r,c){var l=void 0,f=this;if(t instanceof Element)l=t;else{if(i(t))return t;if(o(t))try{l=this.bouer.el.querySelector(t)}catch(e){return t}}if(n(l))throw e.error("Invalid element passed in app.toJsObj(...)");var d=function(e){return e.split(",").map((function(e){return s(e.replace("[","").replace("]",""))}))},p=d((r=r||{}).names||"[name]"),m=d(r.values||"[value]"),b=function(e){var t={},r={BUTTON:!0},n={checkbox:!0,radio:!0};return function e(i){var o=h(i,p);if(o){var a=o.value;if(!0===r[i.tagName])return;if(i instanceof HTMLInputElement&&!0===n[i.type]&&!1===i.checked)return;var s=t[a],l=i.hasAttribute(w.array),d=function(e){var t=void 0;return m.find((function(r){return!!(t=N.value(e,r))})),t}(i);t[a]=l?s?A.array(s,d):[d]:s?A.array(s,d):d,u(c)&&c.call(f,t,a,d,i)}v([].slice.call(i.children),(function(t){h(t,[w.build])||e(t)}))}(e),t},y=b(l),g=[].slice.call(l.querySelectorAll("["+w.build+"]"));return v(g,(function(e){var t=N.value(e,w.build),r=e.hasAttribute(w.array),o=b(e);(function(e){if(a(e))return!1;for(var t=!1,r=Object.keys(e),i=0;i<r.length;i++)if(!n(r[i])){t=!0;break}return t})(o)&&function t(s,l){var d=s.split("."),p=d[0];d.shift();var h=l[p];return n(h)&&(l[p]={}),0===d.length?(r?i(h)&&!a(h)?l[p]=[A.obj(h,o)]:Array.isArray(h)?h.push(o):l[p]=[o]:n(h)?l[p]=o:l[p]=A.obj(h,o),void(u(c)&&c.call(f,l,p,o,e))):Array.isArray(h)?v(h,(function(e){t(d.join("."),e)})):void t(d.join("."),l[p])}(t,y)})),y},t.prototype.compile=function(t){var r=this,n=t.el,i=t.data||this.bouer.data;if(this.analizer(n.outerHTML)){var a=function(t,i){if(!(t.nodeName in r.NODES_TO_IGNORE_IN_COMPILATION)){if(t instanceof Element){if(w.ignore in t.attributes)return r.directive.ignore(t);if(w.def in t.attributes&&r.directive.def(t.attributes[w.def],i),w.wait in t.attributes)return r.directive.wait(t.attributes[w.wait],i);if(w.copy in t.attributes&&r.directive.copy(t),w.data in t.attributes)return r.directive.data(t.attributes[w.data],i);if(w.for in t.attributes)return r.directive.for(t.attributes[w.for],i).connect(n);if(w.if in t.attributes)return r.directive.if(t.attributes[w.if],i);if((w.elseif in t.attributes||w.else in t.attributes)&&e.warn('The "'+w.elseif+'" or "'+w.else+'" requires an element with "'+w.if+'" above.'),w.show in t.attributes)return r.directive.show(t.attributes[w.show],i).connect(n);if(w.component in t.attributes)return r.directive.component(t.attributes[w.component],i);var u=null;if((u=t.attributes[w.req])||(u=[].slice.call(t.attributes).find((function(e){return w.check(e,w.req)}))))return r.directive.req(u,i);if(w.href in t.attributes||w.ihref in t.attributes)return r.directive.href(t.attributes[w.href],i).connect(n);v([].slice.call(t.attributes),(function(e){a(e,i)}))}if(w.check(t,w.content))return r.directive.content(t);if(w.check(t,w.bind))return r.directive.bind(t,i).connect(n);if(w.check(t,w.property)&&!w.isConstant(t.nodeName)&&r.directive.property(t,i).connect(n),w.check(t,w.on))return r.eventHandler.handle(t,i);var s;o(t.nodeValue)&&(s=r.delimiter.run(t.nodeValue))&&0!==s.length&&r.binder.create({node:y(t,n),fields:s,data:i});var c=t.childNodes[0];do{if(!c)break;a(c,i)}while(c=c.nextSibling)}};a(n,i),u(t.onDone)&&t.onDone.call(this.bouer,n)}},t.prototype.analizer=function(e){return!0},t}(),B=function(){function e(){}return e.observe=function(e,t){var r=new MutationObserver((function(n){t({element:e,mutation:r,records:n})}));r.observe(e,{childList:!0})},e}();return function(){function r(r,i){if(this.name="Bouer",this.version="3.0.0",Object.assign(this,i||{}),n(r)||""===s(r))throw e.error("Invalid selector provided to the instance.");var o=this,a=t.querySelector(r);if(n(a))throw e.error("Element with selector '"+r+"' not found.");this.el=a,o.beforeMount(o.el,o),new x(this),new I(this),this.data=V.transform(i.data||{}),this.globalData=V.transform(i.globalData||{}),o.mounted(o.el,o);var u=new g([{name:"bouer",delimiter:{open:"-e-",close:"-"}},{name:"common",delimiter:{open:"{{",close:"}}"}},{name:"html",delimiter:{open:"{{:html ",close:"}}"}}]);new j(this),new k(this);var c=new S(this);new I(this),o.beforeLoad(o.el,o),c.compile({el:this.el,data:this.data,onDone:function(){o.loaded(o.el,o)}}),B.observe(this.el,(function(e){var t=e.mutation;!1===e.element.isConnected&&(o.destroyed(o.el,o),t.disconnect())})),this.delimiters={add:u.add,remove:u.remove,get:function(){return u.delimiters}},t.head.querySelector("link[rel~='icon']")||m("link",(function(e){e.rel="icon",e.type="image/png",e.href="https://afonsomatelias.github.io/easy/assets/img/main_ico.png"})).appendTo(t.head)}return r.prototype.toJsObj=function(e,t,r){return S.singleton.toJsObj(e,t,r)},r.prototype.setData=function(t,r){return i(t)?null!==r&&i(r)?(r=this.data,V.transform(t),v(Object.keys(t),(function(e){return d(r,t,e)})),r):e.error('Invalid targetObject value, expected an "Object Literal" and got "'+typeof r+'".'):e.error('Invalid inputData value, expected an "Object Literal" and got "'+typeof t+'".')},r.prototype.beforeMount=function(e,t){},r.prototype.mounted=function(e,t){},r.prototype.beforeLoad=function(e,t){},r.prototype.loaded=function(e,t){},r.prototype.destroyed=function(e,t){},r}()}));
